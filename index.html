<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hardware Savings Calculator | Sighthound</title>
    <!-- Fonts: Poppins for headings, Lexend for body text -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&display=swap"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Configure Tailwind CDN to use class-based dark mode
      tailwind.config = {
        darkMode: "class",
      };
    </script>
    <script src="script.js"></script>
    <style>
      :root {
        --font-body: "Lexend", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
        --font-heading: "Lexend", system-ui, -apple-system, BlinkMacSystemFont,
          "Segoe UI", sans-serif;
      }

      body {
        font-family: var(--font-body);
      }

      h1,
      h2,
      h3,
      h4,
      h5,
      h6 {
        font-family: var(--font-heading);
      }
    </style>
  </head>
  <body class="min-h-screen bg-slate-50 text-slate-900 antialiased dark:bg-slate-950 dark:text-slate-50">
    <div class="min-h-screen">
      <!-- Top header / branding -->
      <header class="border-b border-slate-200/80 bg-white/80 backdrop-blur dark:border-slate-700/80 dark:bg-slate-900/80">
        <div class="mx-auto flex max-w-6xl items-center justify-between px-4 py-4 lg:py-5">
          <div class="flex items-center gap-3">
            <img
              id="headerLogo"
              src="assets/sighthound-logo-black.png"
              data-logo-light="assets/sighthound-logo-black.png"
              data-logo-dark="assets/sighthound-logo-white.png"
              alt="Sighthound"
              class="h-8 w-auto shrink-0"
              onerror="this.style.display='none'"
            />
          </div>
          <button
            id="themeToggle"
            type="button"
            class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white/80 px-3 py-1.5 text-xs font-medium text-slate-700 shadow-sm hover:bg-slate-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2 dark:border-slate-600 dark:bg-slate-800/80 dark:text-slate-100 dark:hover:bg-slate-700 dark:focus-visible:ring-offset-slate-900"
            aria-pressed="false"
          >
            <span
              id="themeToggleIcon"
              class="inline-flex h-5 w-5 items-center justify-center rounded-full bg-slate-900 text-[0.65rem] font-semibold text-white dark:bg-slate-100 dark:text-slate-900"
              aria-hidden="true"
            >
              ☾
            </span>
            <span id="themeToggleLabel" class="hidden sm:inline">
              Dark mode
            </span>
          </button>
        </div>
      </header>

      <!-- Main content -->
      <main class="flex-1">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-10">
          <h1 class="text-xl sm:text-2xl font-semibold tracking-tight text-slate-900 dark:text-slate-50 mb-3">
            Hardware Savings Calculator
          </h1>
          <p class="text-sm sm:text-base text-slate-600 dark:text-slate-300 mb-4">
            Estimate hardware savings in under a minute by comparing smart AI cameras with Sighthound Compute Hardware plus standard IP cameras.
          </p>
          <section class="mb-6 space-y-2 text-sm text-slate-600 dark:text-slate-300">
            <h2 class="text-sm font-semibold text-slate-900 dark:text-slate-50">
              How this works
            </h2>
            <div class="mt-1 inline-flex flex-wrap items-center gap-2 text-[11px] sm:text-xs font-medium text-slate-700 dark:text-slate-200">
              <div class="inline-flex items-center gap-1 rounded-full bg-slate-100 px-2.5 py-1 dark:bg-slate-800">
                <span class="h-1.5 w-1.5 rounded-full bg-slate-900 dark:bg-slate-100"></span>
                <span class="uppercase tracking-wide">Step 1</span>
                <span class="text-slate-500 dark:text-slate-400">Enter cameras &amp; hardware costs</span>
              </div>
              <div class="inline-flex items-center gap-1 rounded-full bg-slate-100 px-2.5 py-1 dark:bg-slate-800">
                <span class="h-1.5 w-1.5 rounded-full bg-sky-600"></span>
                <span class="uppercase tracking-wide">Step 2</span>
                <span class="text-slate-500 dark:text-slate-400">Review savings &amp; deployment details</span>
              </div>
              <span class="ml-1 text-[11px] font-normal text-sky-700 dark:text-sky-400">
                Updates instantly as you type.
              </span>
            </div>
          </section>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8 items-start">
            <!-- Inputs column -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-5 sm:p-6 space-y-5 dark:bg-slate-900 dark:border-slate-700">
              <h2 class="text-base font-semibold text-slate-900 dark:text-slate-50">
                Your setup
              </h2>
              <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">
                Enter your camera count and typical hardware costs for your deployment.
              </p>

              <div class="space-y-4">
                <!-- Total cameras -->
                <div class="space-y-1.5">
                  <label
                    for="totalCameras"
                    class="block text-sm font-medium text-slate-700 dark:text-slate-200"
                  >
                    Total cameras
                    <span
                      class="ml-2 inline-flex items-center rounded-full bg-rose-50 px-2 py-0.5 text-[11px] font-semibold uppercase tracking-wide text-rose-600 dark:bg-rose-950/40 dark:text-rose-300"
                    >
                      Required
                    </span>
                  </label>
                  <input
                    id="totalCameras"
                    type="number"
                    inputmode="numeric"
                    min="1"
                    max="10000"
                    step="1"
                    placeholder="Total cameras"
                    class="block w-full rounded-lg border border-slate-300 bg-white px-3 py-2 text-sm shadow-sm focus:border-sky-500 focus:ring-1 focus:ring-sky-500 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100"
                  />
                  <p class="text-xs text-slate-500 dark:text-slate-400">
                    Enter the total number of camera channels in your deployment.
                  </p>
                </div>

                <!-- Smart camera cost -->
                <div class="space-y-1.5">
                  <label
                    for="smartCameraCost"
                    class="block text-sm font-medium text-slate-700 dark:text-slate-200"
                  >
                    Smart camera cost (today)
                  </label>
                  <div class="relative rounded-lg shadow-sm">
                    <div
                      class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-slate-500 text-sm"
                    >
                      $
                    </div>
                    <input
                      id="smartCameraCost"
                      type="number"
                      inputmode="decimal"
                      min="1"
                      max="10000"
                      step="1"
                      value="3000"
                      class="block w-full rounded-lg border border-slate-300 bg-white pl-7 pr-3 py-2 text-sm focus:border-sky-500 focus:ring-1 focus:ring-sky-500 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100"
                    />
                  </div>
                  <p class="text-xs text-slate-500 dark:text-slate-400">
                    Per smart AI camera (hardware only).
                  </p>
                </div>

                <!-- IP camera cost -->
                <div class="space-y-1.5">
                  <label
                    for="dumbCameraCost"
                    class="block text-sm font-medium text-slate-700 dark:text-slate-200"
                  >
                    IP camera cost (with Sighthound)
                  </label>
                  <div class="relative rounded-lg shadow-sm">
                    <div
                      class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-slate-500 text-sm"
                    >
                      $
                    </div>
                    <input
                      id="dumbCameraCost"
                      type="number"
                      inputmode="decimal"
                      min="1"
                      max="10000"
                      step="1"
                      value="250"
                      class="block w-full rounded-lg border border-slate-300 bg-white pl-7 pr-3 py-2 text-sm focus:border-sky-500 focus:ring-1 focus:ring-sky-500 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100"
                    />
                  </div>
                  <p class="text-xs text-slate-500 dark:text-slate-400">
                    Per IP camera with Sighthound (hardware only).
                  </p>
                </div>
              </div>

              <!-- Optional software cost input -->
              <div class="mt-4 border-t border-slate-200 pt-4 space-y-2 dark:border-slate-700">
                <h3 class="flex items-center gap-2 text-xs font-semibold uppercase tracking-wide text-slate-500 dark:text-slate-400">
                  <span>Optional: your current software cost</span>
                  <span
                    class="inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-slate-600 dark:bg-slate-800 dark:text-slate-300"
                  >
                    Optional
                  </span>
                </h3>
                <div class="space-y-1.5">
                  <label
                    for="currentSoftwareCostPerCamera"
                    class="block text-sm font-medium text-slate-700 dark:text-slate-200"
                  >
                    Your current software cost per camera per month (optional)
                  </label>
                  <div class="relative rounded-lg shadow-sm max-w-xs">
                    <div
                      class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3 text-slate-500 text-sm"
                    >
                      $
                    </div>
                    <input
                      id="currentSoftwareCostPerCamera"
                      type="number"
                      inputmode="decimal"
                      min="0"
                      max="1000"
                      step="1"
                      placeholder="e.g. 40"
                      class="block w-full rounded-lg border border-slate-300 bg-white pl-7 pr-3 py-2 text-sm focus:border-sky-500 focus:ring-1 focus:ring-sky-500 dark:border-slate-600 dark:bg-slate-900 dark:text-slate-100"
                    />
                  </div>
                  <p class="text-xs text-slate-500 dark:text-slate-400">
                    This is not included in the hardware savings above. We assume Sighthound software at
                    <span class="font-medium">$30 / camera / month</span> when showing the optional software comparison.
                  </p>
                </div>
              </div>

              <div class="mt-2 flex items-center justify-end">
                <button
                  id="resetCalculatorButton"
                  type="button"
                  class="inline-flex items-center justify-center rounded-lg border border-slate-300 px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2 dark:border-slate-600 dark:text-slate-100 dark:hover:bg-slate-800 dark:focus-visible:ring-offset-slate-900"
                >
                  <span aria-hidden="true" class="mr-1.5 text-[0.8rem]">
                    ↻
                  </span>
                  <span>Reset calculations</span>
                </button>
              </div>
            </section>

            <!-- Results column -->
            <section class="space-y-4">
              <!-- Placeholder state -->
              <div
                id="resultsPlaceholder"
                class="bg-white rounded-xl shadow-sm border border-dashed border-slate-300 p-6 flex items-center justify-center text-center min-h-[220px] dark:bg-slate-900 dark:border-slate-700"
              >
                <p class="text-sm text-slate-500 dark:text-slate-400">
                  Enter your camera count to see results.
                </p>
              </div>

              <!-- Results -->
              <div id="resultsPanel" class="hidden space-y-4">
                <!-- Cost comparison -->
                <div
                  class="bg-white rounded-xl shadow-sm border border-slate-200 p-5 sm:p-6 dark:bg-slate-900 dark:border-slate-700"
                >
                  <h3 class="text-sm font-semibold text-slate-800 mb-1 dark:text-slate-50">
                    Your hardware costs
                  </h3>
                  <p class="mb-3 text-xs text-slate-500 dark:text-slate-400">
                    A side-by-side view of todays approach versus Sighthound Compute Hardware.
                  </p>
                  <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <!-- Today -->
                    <div class="border border-slate-200 rounded-lg p-4 flex flex-col gap-1.5 dark:border-slate-700">
                      <p class="flex items-center justify-between gap-2 text-xs font-medium text-slate-600 uppercase tracking-wide dark:text-slate-400">
                        <span>Today  smart AI cameras</span>
                        <span
                          class="inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-slate-600 dark:bg-slate-800 dark:text-slate-300"
                        >
                          Before
                        </span>
                      </p>
                      <p
                        id="currentTotalValue"
                        class="text-lg font-semibold tabular-nums text-slate-900 dark:text-slate-50"
                      >
                        $0.00
                      </p>
                    </div>

                    <!-- Sighthound -->
                    <div class="border border-sky-300 rounded-lg p-4 flex flex-col gap-1.5 bg-sky-50/70 shadow-sm dark:border-sky-500/70 dark:bg-sky-950/40">
                      <p class="text-xs font-medium text-slate-700 uppercase tracking-wide flex items-center justify-between gap-2 dark:text-slate-100">
                        <span>With Sighthound Compute Hardware</span>
                        <span class="inline-flex items-center rounded-full bg-sky-600/10 px-2 py-0.5 text-[10px] font-semibold uppercase tracking-wide text-sky-700 dark:bg-sky-500/20 dark:text-sky-200">
                          After
                        </span>
                      </p>
                      <p
                        id="sighthoundTotalValue"
                        class="text-lg sm:text-xl font-semibold tabular-nums text-slate-900 dark:text-slate-50"
                      >
                        $0.00
                      </p>
                    </div>
                  </div>

                  <div class="mt-3 space-y-1 rounded-lg border border-slate-200 bg-slate-50/80 p-3 dark:border-slate-700 dark:bg-slate-900/60">
                    <div class="flex items-start gap-2">
                      <input
                        id="existingCamerasToggle"
                        type="checkbox"
                        class="mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500 dark:border-slate-600"
                      />
                      <label
                        for="existingCamerasToggle"
                        class="text-xs font-medium text-slate-700 dark:text-slate-300"
                      >
                        We already have standard IP cameras installed in this system.
                      </label>
                    </div>
                    <p
                      id="existingCamerasHelper"
                      class="text-xs text-slate-500 dark:text-slate-400"
                    >
                      Use this if you already have standard IP cameras installed and won't be buying new ones.
                    </p>
                  </div>

                  <!-- Progressive breakdown -->
                  <div class="mt-4 border-t border-slate-200 pt-4 dark:border-slate-700">
                    <button
                      id="breakdownToggle"
                      type="button"
                      class="text-xs font-medium text-sky-700 hover:text-sky-800 flex items-center gap-1 dark:text-sky-400 dark:hover:text-sky-300"
                      aria-expanded="false"
                    >
                      Show breakdown
                    </button>
                    <div
                      id="breakdownPanel"
                      class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-4 text-xs text-slate-600 tabular-nums hidden dark:text-slate-400"
                    >
                      <div class="space-y-1.5">
                        <p class="font-medium text-slate-700 dark:text-slate-200">Today</p>
                        <p id="todayBreakdownLine" class="text-slate-600 dark:text-slate-400">
                          Cameras: –
                        </p>
                      </div>
                      <div class="space-y-1.5">
                        <p class="font-medium text-slate-700 dark:text-slate-200">Sighthound Compute Hardware</p>
                        <p id="sighthoundBreakdownNodes" class="text-slate-600 dark:text-slate-400">
                          Compute Nodes: 2
                        </p>
                        <p id="sighthoundBreakdownCameras" class="text-slate-600 dark:text-slate-400">
                          Cameras: 2
                        </p>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Savings card -->
                <div
                  id="primaryCard"
                  class="rounded-xl shadow-sm border border-slate-200 bg-gradient-to-br from-sky-50/80 via-slate-50 to-emerald-50/80 p-5 sm:p-6 flex flex-col gap-4 dark:border-slate-700 dark:from-slate-900 dark:via-slate-900 dark:to-slate-900"
                >
                  <div class="flex items-start justify-between gap-4">
                    <div>
                      <p
                        id="primaryLabel"
                        class="text-sm font-medium text-slate-700 flex items-center gap-1.5 dark:text-slate-200"
                      >
                        <span> Savings vs today </span>
                      </p>
                      <p
                        id="primaryValue"
                        class="mt-1 text-3xl sm:text-4xl font-semibold tracking-tight tabular-nums"
                      >
                        $0.00
                      </p>
                      <p class="mt-1 text-xs text-slate-500 dark:text-slate-400">
                        The difference between your current hardware spend and the Sighthound Compute Hardware approach.
                      </p>
                    </div>
                    <div class="flex flex-col items-end gap-2">
                      <div
                        id="primaryArrow"
                        class="inline-flex h-8 w-8 items-center justify-center rounded-full bg-emerald-50 text-emerald-600 dark:bg-emerald-950 dark:text-emerald-400"
                        aria-hidden="true"
                      >
                        <svg
                          id="primaryArrowIcon"
                          xmlns="http://www.w3.org/2000/svg"
                          viewBox="0 0 20 20"
                          fill="currentColor"
                          class="h-4 w-4"
                        >
                          <path
                            fill-rule="evenodd"
                            d="M10 2a.75.75 0 0 1 .75.75v12.638l3.72-3.719a.75.75 0 1 1 1.06 1.06l-5.25 5.25a.75.75 0 0 1-1.06 0l-5.25-5.25a.75.75 0 1 1 1.06-1.06l3.72 3.719V2.75A.75.75 0 0 1 10 2Z"
                            clip-rule="evenodd"
                          />
                        </svg>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Secondary metrics -->
                <div
                  class="bg-white rounded-xl shadow-sm border border-slate-200 p-5 sm:p-6 space-y-4 dark:bg-slate-900 dark:border-slate-700"
                >
                  <h3 class="text-sm font-semibold text-slate-800 dark:text-slate-50">
                    Deployment details
                  </h3>
                  <p class="text-xs text-slate-500 dark:text-slate-400">
                    A quick breakdown of Compute Nodes required, cost reduction, and cost per camera.
                  </p>
                  <p class="text-[11px] text-slate-500 dark:text-slate-500">
                    Assumes a typical maximum camera count per Compute Node under standard workloads. Your actual node count may vary based on retention and AI workloads.
                  </p>
                  <dl class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm">
                    <div class="space-y-1">
                      <dt class="text-xs text-slate-500 dark:text-slate-400">Compute Nodes required</dt>
                      <dd
                        id="nodesNeededValue"
                        class="font-medium tabular-nums text-slate-900 dark:text-slate-50"
                      >
                        0
                      </dd>
                    </div>

                    <div class="space-y-1">
                      <dt class="text-xs text-slate-500 dark:text-slate-400">% reduction</dt>
                      <dd class="flex items-center gap-1.5">
                        <span
                          id="percentReductionValue"
                          class="font-medium tabular-nums text-emerald-600"
                        >
                          0.0%
                        </span>
                        <span
                          id="percentArrowIcon"
                          class="inline-flex h-5 w-5 items-center justify-center rounded-full bg-emerald-50 text-emerald-600 dark:bg-emerald-950 dark:text-emerald-400"
                          aria-hidden="true"
                        >
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 20 20"
                            fill="currentColor"
                            class="h-3 w-3"
                          >
                            <path
                              fill-rule="evenodd"
                              d="M10 2a.75.75 0 0 1 .75.75v12.638l3.72-3.719a.75.75 0 1 1 1.06 1.06l-5.25 5.25a.75.75 0 0 1-1.06 0l-5.25-5.25a.75.75 0 1 1 1.06-1.06l3.72 3.719V2.75A.75.75 0 0 1 10 2Z"
                              clip-rule="evenodd"
                            />
                          </svg>
                        </span>
                      </dd>
                    </div>

                    <div class="space-y-1">
                  <dt class="text-xs text-slate-500 dark:text-slate-400">Cost per camera (hardware only)</dt>
                      <dd class="space-y-0.5">
                        <div class="flex items-center justify-between gap-2">
                          <span class="text-xs text-slate-500 dark:text-slate-400">Before</span>
                          <span
                            id="costPerCameraBeforeValue"
                            class="font-medium tabular-nums text-slate-900 dark:text-slate-50"
                          >
                            $0.00
                          </span>
                        </div>
                        <div class="flex items-center justify-between gap-2">
                          <span class="text-xs text-slate-500 dark:text-slate-400">After</span>
                          <span
                            id="costPerCameraAfterValue"
                            class="font-medium tabular-nums text-slate-900 dark:text-slate-50"
                          >
                            $0.00
                          </span>
                        </div>
                      </dd>
                    </div>
                  </dl>

                  <!-- Optional software monthly comparison -->
                  <div
                    id="softwareComparison"
                    class="mt-4 hidden border-t border-slate-200 pt-4 space-y-1 text-xs text-slate-500 dark:border-slate-700 dark:text-slate-400"
                  >
                    <p class="font-semibold text-slate-700 dark:text-slate-200">
                      Software costs (monthly, optional estimate)
                    </p>
                    <p id="softwareCurrentMonthlyLine">Your software per month: </p>
                    <p id="softwareSighthoundMonthlyLine">Estimated Sighthound software per month: </p>
                    <p id="softwareDeltaMonthlyLine" class="font-semibold">
                      Monthly software difference: 
                    </p>
                    <p>
                      Software costs are <span class="font-semibold">not included</span> in the hardware totals or savings above.
                    </p>
                  </div>
                </div>

                <!-- CTA -->
                <aside
                  class="rounded-xl shadow-sm border border-slate-200 bg-gradient-to-r from-slate-50 to-slate-100/80 p-5 sm:p-6 flex flex-col gap-3 dark:border-slate-700 dark:from-slate-900 dark:to-slate-900"
                >
                  <h3 class="text-sm font-semibold text-slate-900 dark:text-slate-50">
                    Ready to order your trial kit?
                  </h3>
                  <label
                    for="shareDetailsConsent"
                    class="mt-1 flex items-start gap-2 text-xs text-slate-600 dark:text-slate-400"
                  >
                    <input
                      id="shareDetailsConsent"
                      type="checkbox"
                      class="mt-0.5 h-3.5 w-3.5 rounded border-slate-300 text-sky-600 focus:ring-sky-500 dark:border-slate-600"
                    />
                    <span>
                      Share your camera counts, retention, and AI workloads and our
                      team will size a full solution for you.
                    </span>
                  </label>
                  <div class="mt-2 flex flex-col gap-2">
                    <a
                      id="primaryCtaLink"
                      href="https://www.sighthound.com/contact-us"
                      class="inline-flex items-center justify-center rounded-lg bg-sky-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-sky-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-sky-500 focus-visible:ring-offset-2 dark:focus-visible:ring-offset-slate-950"
                      target="_blank"
                      rel="noreferrer"
                    >
                      Request a trial kit
                    </a>
                    <a
                      id="secondaryCtaLink"
                      href="mailto:support@sighthound.com"
                      class="inline-flex items-center justify-center rounded-lg border border-slate-300 px-3 py-2 text-sm font-medium text-slate-700 hover:bg-slate-50 dark:border-slate-600 dark:text-slate-100 dark:hover:bg-slate-800"
                    >
                      Email support@sighthound.com
                    </a>
                  </div>
                  <p class="mt-1 text-[11px] text-slate-500 dark:text-slate-400">
                    Hardware-only estimate.
                  </p>
                </aside>
              </div>
            </section>
          </div>
        </div>
      </main>
    </div>

    <script>
      // Constants (hidden from UI)
      const CONTACT_BASE_URL = "https://www.sighthound.com/contact-us";
      const SUPPORT_EMAIL = "support@sighthound.com";

      const Calculator = window.SighthoundCalculator;

      // Theme toggle wiring
      const themeToggleButton = document.getElementById("themeToggle");
      const themeToggleLabel = document.getElementById("themeToggleLabel");
      const headerLogo = document.getElementById("headerLogo");

      function setTheme(theme) {
        const root = document.documentElement;
        if (!root) return;

        if (theme === "dark") {
          root.classList.add("dark");
          try {
            localStorage.setItem("theme", "dark");
          } catch (e) {}
          if (themeToggleButton)
            themeToggleButton.setAttribute("aria-pressed", "true");
          if (themeToggleLabel) themeToggleLabel.textContent = "Light mode";
        } else {
          root.classList.remove("dark");
          try {
            localStorage.setItem("theme", "light");
          } catch (e) {}
          if (themeToggleButton)
            themeToggleButton.setAttribute("aria-pressed", "false");
          if (themeToggleLabel) themeToggleLabel.textContent = "Dark mode";
        }

        // Swap header logo based on theme, if both variants are available
        if (headerLogo) {
          const lightSrc = headerLogo.getAttribute("data-logo-light");
          const darkSrc = headerLogo.getAttribute("data-logo-dark");
          if (theme === "dark" && darkSrc) {
            headerLogo.src = darkSrc;
          } else if (theme === "light" && lightSrc) {
            headerLogo.src = lightSrc;
          }
        }
      }

      // Initialise theme from saved preference or OS setting
      (function initTheme() {
        try {
          const stored = localStorage.getItem("theme");
          const prefersDark =
            window.matchMedia &&
            window.matchMedia("(prefers-color-scheme: dark)").matches;
          const initial = stored || (prefersDark ? "dark" : "light");
          setTheme(initial);
        } catch (e) {
          setTheme("light");
        }
      })();

      if (themeToggleButton) {
        themeToggleButton.addEventListener("click", () => {
          const isDark = document.documentElement.classList.contains("dark");
          setTheme(isDark ? "light" : "dark");
        });
      }

      // Calculator wiring
      const totalCamerasInput = document.getElementById("totalCameras");
      const smartCameraCostInput = document.getElementById("smartCameraCost");
      const dumbCameraCostInput = document.getElementById("dumbCameraCost");
      const existingCamerasToggle = document.getElementById("existingCamerasToggle");
      const existingCamerasHelper = document.getElementById("existingCamerasHelper");
      const resetCalculatorButton = document.getElementById("resetCalculatorButton");
      const currentSoftwareCostPerCameraInput = document.getElementById(
        "currentSoftwareCostPerCamera"
      );

      const defaultSmartCameraCost = smartCameraCostInput
        ? smartCameraCostInput.value
        : "3000";
      const defaultDumbCameraCost = dumbCameraCostInput
        ? dumbCameraCostInput.value
        : "250";

      const resultsPlaceholder = document.getElementById("resultsPlaceholder");
      const resultsPanel = document.getElementById("resultsPanel");

      const primaryLabel = document.getElementById("primaryLabel");
      const primaryValue = document.getElementById("primaryValue");
      const primaryArrow = document.getElementById("primaryArrow");
      const primaryArrowIcon = document.getElementById("primaryArrowIcon");
      const primaryCard = document.getElementById("primaryCard");

      const currentTotalValue = document.getElementById("currentTotalValue");
      const sighthoundTotalValue = document.getElementById(
        "sighthoundTotalValue"
      );

      const breakdownToggle = document.getElementById("breakdownToggle");
      const breakdownPanel = document.getElementById("breakdownPanel");
      const todayBreakdownLine = document.getElementById("todayBreakdownLine");
      const sighthoundBreakdownNodes = document.getElementById(
        "sighthoundBreakdownNodes"
      );
      const sighthoundBreakdownCameras = document.getElementById(
        "sighthoundBreakdownCameras"
      );

      const shareDetailsCheckbox = document.getElementById(
        "shareDetailsConsent"
      );
      const primaryCtaLink = document.getElementById("primaryCtaLink");
      const secondaryCtaLink = document.getElementById("secondaryCtaLink");

      const nodesNeededValue = document.getElementById("nodesNeededValue");
      const percentReductionValue = document.getElementById(
        "percentReductionValue"
      );
      const percentArrowIcon = document.getElementById("percentArrowIcon");
      const costPerCameraBeforeValue = document.getElementById(
        "costPerCameraBeforeValue"
      );
      const costPerCameraAfterValue = document.getElementById(
        "costPerCameraAfterValue"
      );
      const softwareComparison = document.getElementById("softwareComparison");
      const softwareCurrentMonthlyLine = document.getElementById(
        "softwareCurrentMonthlyLine"
      );
      const softwareSighthoundMonthlyLine = document.getElementById(
        "softwareSighthoundMonthlyLine"
      );
      const softwareDeltaMonthlyLine = document.getElementById(
        "softwareDeltaMonthlyLine"
      );

      function resetCtaLinks() {
        if (primaryCtaLink) {
          primaryCtaLink.href = CONTACT_BASE_URL;
        }
        if (secondaryCtaLink) {
          secondaryCtaLink.href = `mailto:${SUPPORT_EMAIL}`;
        }
      }

      function syncUrlParams(totalCameras, smartCameraCost, dumbCameraCost) {
        if (!window || !window.history || !window.location) return;
        try {
          const url = new URL(window.location.href);
          url.searchParams.set("cameras", String(totalCameras));
          url.searchParams.set("smart", String(smartCameraCost));
          url.searchParams.set("dumb", String(dumbCameraCost));
          window.history.replaceState({}, "", url.toString());
        } catch (e) {}
      }

      function clearUrlParams() {
        if (!window || !window.history || !window.location) return;
        try {
          const url = new URL(window.location.href);
          url.searchParams.delete("cameras");
          url.searchParams.delete("smart");
          url.searchParams.delete("dumb");
          window.history.replaceState({}, "", url.toString());
        } catch (e) {}
      }

      function updateCtaLinks(context) {
        if (!primaryCtaLink || !secondaryCtaLink || !shareDetailsCheckbox) {
          return;
        }

        if (!shareDetailsCheckbox.checked) {
          resetCtaLinks();
          return;
        }

        const {
          totalCameras,
          smartCameraCost,
          dumbCameraCost,
          nodesNeeded,
          currentTotal,
          sighthoundTotal,
          savings,
          percentReduction,
          costPerCameraBefore,
          costPerCameraAfter,
        } = context;

        try {
          const contactUrl = new URL(CONTACT_BASE_URL);
          contactUrl.searchParams.set("source", "hardware-calculator");
          contactUrl.searchParams.set("cameras", String(totalCameras));
          contactUrl.searchParams.set("smart", String(smartCameraCost));
          contactUrl.searchParams.set("dumb", String(dumbCameraCost));
          contactUrl.searchParams.set("nodes", String(nodesNeeded));
          contactUrl.searchParams.set("savings", savings.toFixed(2));
          contactUrl.searchParams.set("pct", percentReduction.toFixed(1));
          primaryCtaLink.href = contactUrl.toString();
        } catch (e) {
          resetCtaLinks();
        }

        try {
          const bodyLines = [
            "Sighthound Compute Hardware savings calculator details:",
            "",
            `Total cameras: ${totalCameras.toLocaleString("en-US")}`,
            `Smart camera cost (today): ${Calculator.formatCurrency(
              smartCameraCost
            )}`,
            `IP camera cost (with Sighthound): ${Calculator.formatCurrency(
              dumbCameraCost
            )}`,
            "",
            `Nodes required: ${nodesNeeded.toLocaleString("en-US")}`,
            `Today total: ${Calculator.formatCurrency(currentTotal)}`,
            `Sighthound total: ${Calculator.formatCurrency(sighthoundTotal)}`,
            `Savings: ${Calculator.formatCurrency(savings)} (${Calculator.formatPercent(
              percentReduction
            )})`,
            "",
            `Cost per camera before: ${Calculator.formatCurrency(
              costPerCameraBefore
            )}`,
            `Cost per camera after: ${Calculator.formatCurrency(costPerCameraAfter)}`,
            "",
            `Calculator link: ${window.location.href}`,
          ];
          const mailtoParams = new URLSearchParams({
            subject: "Sighthound hardware calculator estimate",
            body: bodyLines.join("\n"),
          });
          secondaryCtaLink.href = `mailto:${SUPPORT_EMAIL}?${mailtoParams.toString()}`;
        } catch (e) {
          secondaryCtaLink.href = `mailto:${SUPPORT_EMAIL}`;
        }
      }

      if (breakdownToggle && breakdownPanel) {
        breakdownToggle.addEventListener("click", () => {
          const isHidden = breakdownPanel.classList.contains("hidden");
          if (isHidden) {
            breakdownPanel.classList.remove("hidden");
            breakdownToggle.textContent = "Hide breakdown";
            breakdownToggle.setAttribute("aria-expanded", "true");
          } else {
            breakdownPanel.classList.add("hidden");
            breakdownToggle.textContent = "Show breakdown";
            breakdownToggle.setAttribute("aria-expanded", "false");
          }
        });
      }

      if (resetCalculatorButton) {
        resetCalculatorButton.addEventListener("click", resetCalculator);
      }

      if (shareDetailsCheckbox) {
        shareDetailsCheckbox.addEventListener("change", () => {
          updateResults();
        });
      }

      if (existingCamerasToggle) {
        existingCamerasToggle.addEventListener("change", () => {
          updateResults();
        });
      }


      function resetCalculator() {
        if (totalCamerasInput) {
          totalCamerasInput.value = "";
        }
        if (smartCameraCostInput) {
          smartCameraCostInput.value = defaultSmartCameraCost;
        }
        if (dumbCameraCostInput) {
          dumbCameraCostInput.value = defaultDumbCameraCost;
        }
        if (shareDetailsCheckbox) {
          shareDetailsCheckbox.checked = false;
        }
        if (existingCamerasToggle) {
          existingCamerasToggle.checked = false;
        }
        if (currentSoftwareCostPerCameraInput) {
          currentSoftwareCostPerCameraInput.value = "";
        }
        clearUrlParams();
        updateResults();
      }

      function updateResults() {
        const hasExistingCameras = existingCamerasToggle
          ? existingCamerasToggle.checked
          : false;

        if (existingCamerasHelper) {
          existingCamerasHelper.textContent = hasExistingCameras
            ? "Sighthound cost now excludes new camera hardware  using your existing IP cameras."
            : "Use this if you already have standard IP cameras installed and won't be buying new ones.";
        }

        const currentSoftwarePerCameraRaw = currentSoftwareCostPerCameraInput
          ? currentSoftwareCostPerCameraInput.value
          : "";
        const currentSoftwarePerCamera = currentSoftwarePerCameraRaw.trim()
          ? Number(currentSoftwarePerCameraRaw)
          : null;

        const totalCamerasRaw = totalCamerasInput ? totalCamerasInput.value : "";
        const smartCameraCostRaw = smartCameraCostInput
          ? smartCameraCostInput.value
          : "";
        const dumbCameraCostRaw = dumbCameraCostInput
          ? dumbCameraCostInput.value
          : "";

        const baseResult = Calculator.computeTotalsFromRaw({
          totalCamerasRaw,
          smartCameraCostRaw,
          dumbCameraCostRaw,
        });

        if (!baseResult.ok) {
          resultsPanel.classList.add("hidden");
          resultsPlaceholder.classList.remove("hidden");
          resetCtaLinks();
          return;
        }

        const {
          totalCameras,
          smartCameraCost,
          dumbCameraCost,
          nodesNeeded,
          currentTotal,
        } = baseResult.values;

        const sighthoundCameraHardwareTotal = hasExistingCameras
          ? 0
          : totalCameras * dumbCameraCost;
        const sighthoundTotal =
          nodesNeeded * Calculator.NODE_COST + sighthoundCameraHardwareTotal;
        const savings = currentTotal - sighthoundTotal;
        const percentReduction =
          currentTotal === 0 ? 0 : (savings / currentTotal) * 100;
        const costPerCameraBefore =
          totalCameras === 0 ? 0 : currentTotal / totalCameras;
        const costPerCameraAfter =
          totalCameras === 0 ? 0 : sighthoundTotal / totalCameras;

        // Optional software monthly comparison (does not affect hardware totals)
        let softwareCurrentMonthly = null;
        let softwareSighthoundMonthly = null;
        let softwareDeltaMonthly = null;

        if (
          currentSoftwarePerCamera !== null &&
          Number.isFinite(currentSoftwarePerCamera) &&
          currentSoftwarePerCamera >= 0
        ) {
          softwareCurrentMonthly = totalCameras * currentSoftwarePerCamera;
          softwareSighthoundMonthly =
            totalCameras * Calculator.SIGHTHOUND_SOFTWARE_COST_PER_CAMERA;
          softwareDeltaMonthly =
            softwareCurrentMonthly - softwareSighthoundMonthly;
        }

        // Toggle panels
        resultsPlaceholder.classList.add("hidden");
        resultsPanel.classList.remove("hidden");

        // Keep URL shareable with current configuration
        syncUrlParams(totalCameras, smartCameraCost, dumbCameraCost);

        const isSavingsPositiveOrZero = savings >= 0;

        // Primary card label + value
        primaryLabel.textContent = isSavingsPositiveOrZero
          ? "Savings vs today"
          : "Extra cost vs today";
        primaryValue.textContent = Calculator.formatCurrency(Math.abs(savings));

        if (primaryCard) {
          primaryCard.className =
            "rounded-xl shadow-sm border p-5 sm:p-6 flex flex-col gap-4 " +
            (isSavingsPositiveOrZero
              ? "border-slate-200 bg-gradient-to-br from-sky-50/80 via-slate-50 to-emerald-50/80 dark:border-slate-700 dark:from-slate-900 dark:via-slate-900 dark:to-slate-900"
              : "border-rose-100 bg-rose-50/80 dark:border-rose-900 dark:bg-rose-950");
        }

        if (primaryLabel) {
          primaryLabel.className =
            "text-sm font-medium flex items-center gap-1.5 " +
            (isSavingsPositiveOrZero
              ? "text-slate-700 dark:text-slate-200"
              : "text-rose-700 dark:text-rose-300");
        }

        if (primaryValue) {
          primaryValue.className =
            "mt-1 text-3xl sm:text-4xl font-semibold tracking-tight tabular-nums " +
            (isSavingsPositiveOrZero
              ? "text-emerald-600 dark:text-emerald-400"
              : "text-rose-600 dark:text-rose-400");
        }

        // Primary arrow styling (down = good / up = bad)
        primaryArrow.className =
          "inline-flex h-8 w-8 items-center justify-center rounded-full " +
          (isSavingsPositiveOrZero
            ? "bg-emerald-50 text-emerald-600"
            : "bg-rose-50 text-rose-600");

        primaryArrowIcon.className =
          "h-4 w-4 transition-transform duration-150" +
          (isSavingsPositiveOrZero ? "" : " rotate-180");

        // Comparison block
        currentTotalValue.textContent = Calculator.formatCurrency(currentTotal);
        sighthoundTotalValue.textContent = Calculator.formatCurrency(sighthoundTotal);

        if (todayBreakdownLine) {
          todayBreakdownLine.textContent = `Cameras: ${totalCameras.toLocaleString(
            "en-US"
          )} × ${Calculator.formatCurrency(smartCameraCost)}`;
        }

        if (sighthoundBreakdownNodes) {
          sighthoundBreakdownNodes.textContent = `Compute Nodes: ${nodesNeeded.toLocaleString(
            "en-US"
          )} x ${Calculator.formatCurrency(Calculator.NODE_COST)}`;
        }

        if (sighthoundBreakdownCameras) {
          if (hasExistingCameras) {
            sighthoundBreakdownCameras.textContent =
              "Cameras: existing standard IP cameras (no new hardware cost)";
          } else {
            sighthoundBreakdownCameras.textContent = `Cameras: ${totalCameras.toLocaleString(
              "en-US"
            )} x ${Calculator.formatCurrency(dumbCameraCost)}`;
          }
        }

        // Secondary metrics
        nodesNeededValue.textContent = nodesNeeded.toLocaleString("en-US");

        percentReductionValue.textContent = Calculator.formatPercent(percentReduction);
        percentReductionValue.className =
          "font-medium tabular-nums " +
          (isSavingsPositiveOrZero ? "text-emerald-600" : "text-rose-600");

        percentArrowIcon.className =
          "inline-flex h-5 w-5 items-center justify-center rounded-full " +
          (isSavingsPositiveOrZero
            ? "bg-emerald-50 text-emerald-600"
            : "bg-rose-50 text-rose-600");

        const percentArrowSvg = percentArrowIcon.querySelector("svg");
        if (percentArrowSvg) {
          percentArrowSvg.className =
            "h-3 w-3 transition-transform duration-150" +
            (isSavingsPositiveOrZero ? "" : " rotate-180");
        }

        costPerCameraBeforeValue.textContent = Calculator.formatCurrency(
          costPerCameraBefore
        );
        costPerCameraAfterValue.textContent = Calculator.formatCurrency(
          costPerCameraAfter
        );

        // Update optional software comparison lines
        if (
          softwareComparison &&
          softwareCurrentMonthlyLine &&
          softwareSighthoundMonthlyLine &&
          softwareDeltaMonthlyLine
        ) {
          if (
            softwareCurrentMonthly !== null &&
            softwareSighthoundMonthly !== null &&
            softwareDeltaMonthly !== null
          ) {
            softwareComparison.classList.remove("hidden");
            softwareCurrentMonthlyLine.textContent =
              "Your software per month: " +
              Calculator.formatCurrency(softwareCurrentMonthly);
            softwareSighthoundMonthlyLine.textContent =
              "Estimated Sighthound software per month: " +
              Calculator.formatCurrency(softwareSighthoundMonthly);
            const isSoftwareSavings = softwareDeltaMonthly < 0;
            const deltaLabelPrefix = isSoftwareSavings
              ? "Monthly software difference (savings): "
              : "Monthly software difference (extra cost): ";
            softwareDeltaMonthlyLine.textContent =
              deltaLabelPrefix +
              Calculator.formatCurrency(Math.abs(softwareDeltaMonthly));
            softwareDeltaMonthlyLine.className =
              "font-semibold " +
              (isSoftwareSavings
                ? "text-emerald-600 dark:text-emerald-400"
                : "text-rose-600 dark:text-rose-400");
          } else {
            softwareComparison.classList.add("hidden");
          }
        }

        updateCtaLinks({
          totalCameras,
          smartCameraCost,
          dumbCameraCost,
          nodesNeeded,
          currentTotal,
          sighthoundTotal,
          savings,
          percentReduction,
          costPerCameraBefore,
          costPerCameraAfter,
        });
      }

      function initFromQueryParams() {
        if (!window || !window.location) return;
        try {
          const url = new URL(window.location.href);
          const camerasParam = url.searchParams.get("cameras");
          const smartParam = url.searchParams.get("smart");
          const dumbParam = url.searchParams.get("dumb");

          if (camerasParam && totalCamerasInput) {
            totalCamerasInput.value = camerasParam;
          }
          if (smartParam && smartCameraCostInput) {
            smartCameraCostInput.value = smartParam;
          }
          if (dumbParam && dumbCameraCostInput) {
            dumbCameraCostInput.value = dumbParam;
          }
        } catch (e) {}
      }

      initFromQueryParams();
      updateResults();

      [
        totalCamerasInput,
        smartCameraCostInput,
        dumbCameraCostInput,
        currentSoftwareCostPerCameraInput,
      ].forEach((input) => {
        if (!input) return;
        input.addEventListener("input", updateResults);
        input.addEventListener("change", updateResults);
      });
    </script>
  </body>
</html>
